#%Module -*- tcl -*-
##
## modulefile
##


proc ModulesHelp { } {

    puts stderr "This module adds the OpenFOAMplus v1706 package to your environment."
    puts stderr ""
}

module-whatis "Adds OpenFOAMplus v1706 to your environment"


conflict openfoam
conflict openfoamplus
prereq gcc-libs
prereq compilers/gnu/4.9.2
prereq mpi/openmpi/1.10.1/gnu-4.9.2

set              oftop             /shared/ucl/apps/openfoamplus/v1706/gnu-4.9.2
set              root              $oftop/OpenFOAM-v1706
set              mod_third_dir     $oftop/ThirdParty-v1706
set p1 [open "| /usr/bin/whoami"]
set userid [string trim [read $p1]]
if {[catch {close $p1} err]} {
        puts stderr "whoami command failed: $err"
}
set local ~/Scratch/OpenFOAMplus/$userid-v1706

setenv BOOST_ARCH_PATH $mod_third_dir/platforms/linux64Gcc/boost_1_64_0
setenv CGAL_ARCH_PATH $mod_third_dir/platforms/linux64Gcc/CGAL-4.9.1
setenv FFTW_ARCH_PATH $mod_third_dir/platforms/linux64Gcc/fftw-3.3.6-pl1
setenv FOAM_APP $root/applications
setenv FOAM_APPBIN $root/platforms/linux64GccDPInt32Opt/bin
setenv FOAM_ETC $root/etc
setenv FOAM_EXT_LIBBIN $mod_third_dir/platforms/linux64GccDPInt32/lib
setenv FOAM_INST_DIR $oftop
setenv FOAM_LIBBIN $root/platforms/linux64GccDPInt32Opt/lib
setenv FOAM_MPI openmpi-system
setenv FOAM_RUN $local/run
setenv FOAM_SETTINGS ""
setenv FOAM_SIGFPE ""
setenv FOAM_SITE_APPBIN $oftop/site/v1706/platforms/linux64GccDPInt32Opt/bin
setenv FOAM_SITE_LIBBIN $oftop/site/v1706/platforms/linux64GccDPInt32Opt/lib
setenv FOAM_SOLVERS $root/applications/solvers
setenv FOAM_SRC $root/src
setenv FOAM_TUTORIALS $root/tutorials
setenv FOAM_USER_APPBIN $local/platforms/linux64GccDPInt32Opt/bin
setenv FOAM_USER_LIBBIN $local/platforms/linux64GccDPInt32Opt/lib
setenv FOAM_UTILITIES $root/applications/utilities
setenv MPI_ARCH_PATH /shared/ucl/apps/openmpi/1.10.1/no-verbs/gnu-4.9.2
setenv MPI_BUFFER_SIZE 20000000
setenv SCOTCH_ARCH_PATH $mod_third_dir/platforms/linux64GccDPInt32/scotch_6.0.3
setenv WM_ARCH linux64
setenv WM_ARCH_OPTION 64
setenv WM_CC gcc
setenv WM_CFLAGS "-m64 -fPIC"
setenv WM_COMPILER Gcc
setenv WM_COMPILER_LIB_ARCH 64
setenv WM_COMPILER_TYPE system
setenv WM_COMPILE_OPTION Opt
setenv WM_CXX g++
setenv WM_CXXFLAGS "-m64 -fPIC -std c++11"
setenv WM_DIR $root/wmake
setenv WM_LABEL_OPTION Int32
setenv WM_LABEL_SIZE 32
setenv WM_LDFLAGS -m64
setenv WM_LINK_LANGUAGE c++
setenv WM_MPLIB SYSTEMOPENMPI
setenv WM_OPTIONS linux64GccDPInt32Opt
setenv WM_OSTYPE POSIX
setenv WM_PRECISION_OPTION DP
setenv WM_PROJECT OpenFOAM
setenv WM_PROJECT_DIR $root
setenv WM_PROJECT_INST_DIR $oftop
setenv WM_PROJECT_USER_DIR $local
setenv WM_PROJECT_VERSION v1706
setenv WM_THIRD_PARTY_DIR $mod_third_dir

prepend-path LD_LIBRARY_PATH $root/platforms/linux64GccDPInt32Opt/lib/dummy
prepend-path LD_LIBRARY_PATH $mod_third_dir/platforms/linux64GccDPInt32/lib
prepend-path LD_LIBRARY_PATH $root/platforms/linux64GccDPInt32Opt/lib
prepend-path LD_LIBRARY_PATH $oftop/site/v1706/platforms/linux64GccDPInt32Opt/lib
prepend-path LD_LIBRARY_PATH $local/platforms/linux64GccDPInt32Opt/lib
prepend-path LD_LIBRARY_PATH $mod_third_dir/platforms/linux64GccDPInt32/lib/openmpi-system
prepend-path LD_LIBRARY_PATH $root/platforms/linux64GccDPInt32Opt/lib/openmpi-system
prepend-path LD_LIBRARY_PATH $mod_third_dir/platforms/linux64Gcc/gperftools-2.5/lib64
prepend-path LD_LIBRARY_PATH $mod_third_dir/platforms/linux64Gcc/boost_1_64_0/lib64
prepend-path LD_LIBRARY_PATH $mod_third_dir/platforms/linux64Gcc/CGAL-4.9.1/lib64
prepend-path LD_LIBRARY_PATH $mod_third_dir/platforms/linux64Gcc/fftw-3.3.6-pl1/lib64

prepend-path PATH $mod_third_dir/platforms/linux64Gcc/gperftools-2.5/bin
prepend-path PATH $local/platforms/linux64GccDPInt32Opt/bin
prepend-path PATH $oftop/site/v1706/platforms/linux64GccDPInt32Opt/bin
prepend-path PATH $root/platforms/linux64GccDPInt32Opt/bin
prepend-path PATH $root/bin
prepend-path PATH $root/wmake
